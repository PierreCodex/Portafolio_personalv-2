<header
  class="fixed top-0 left-0 w-full z-50 border-b border-black/10 dark:border-white/10 md:bg-transparent bg-white/85 backdrop-blur supports-[backdrop-filter]:backdrop-blur"
>
  <div
    class="relative flex justify-between items-center py-3 w-full max-w-4xl px-4 mx-auto"
  >
    <div class="flex items-center gap-3">
      <img class="w-12 h-12" src="/src/assets/LogoPCC (1).svg" alt="Logo" />
      <h1 class="text-xl font-semibold">PierreCodex</h1>
    </div>

    <!-- Bot√≥n Hamburguesa -->
    <button
      id="navToggle"
      aria-label="Abrir men√∫"
      aria-expanded="false"
      aria-controls="primary-nav"
      class="md:hidden p-2 rounded focus:outline-none focus-visible:ring focus-visible:ring-blue-500 hover:bg-black/5 dark:hover:bg-white/10 transition"
    >
      <svg
        id="navIcon"
        class="w-6 h-6"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
      >
        <path d="M3 6h18M3 12h18M3 18h18"></path>
      </svg>
    </button>

    <nav
      id="primary-nav"
      class="hidden md:flex flex-col md:flex-row gap-6 absolute md:static top-full left-0 w-full md:w-auto bg-white/95 dark:bg-black/90 md:bg-transparent md:dark:bg-transparent backdrop-blur md:backdrop-blur-0 px-4 md:px-0 py-4 md:py-0 shadow md:shadow-none rounded-b md:rounded-none z-40"
    >
      <a class="nav-link" href="#experience">üíº Experience</a>
      <a class="nav-link" href="#skills">üõ†Ô∏è Skills</a>
      <a class="nav-link" href="#projects">üöÄ Proyectos</a>
      <a class="nav-link" href="#education">üéì Educacion</a>
     
    </nav>

    <div class="flex items-center gap-3">
      <button
        id="themeToggle"
        type="button"
        class="mt-2 md:mt-0 nav-link flex items-center gap-1 px-2 py-1 rounded-md border border-transparent hover:border-[--first-color]/40 hover:bg-black/5 dark:hover:bg-white/10 transition-colors"
        aria-label="Cambiar tema"
        title="Cambiar tema"
      >
        <span class="inline-flex" id="themeIcon"></span>
      </button>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const btn = document.getElementById('navToggle');
      const nav = document.getElementById('primary-nav');
      const icon = document.getElementById('navIcon');
      const header = document.querySelector('header');
      const links = nav ? Array.from(nav.querySelectorAll('a')) : [];
      const sectionIds = links
        .map(a => a.getAttribute('href') || '')
        .filter(h => h.startsWith('#'))
        .map(h => h.slice(1));

      // Men√∫ m√≥vil
      if (btn && nav) {
        const resetIcon = () => { if (icon) icon.innerHTML = '<path d="M3 6h18M3 12h18M3 18h18" />'; };
        btn.addEventListener('click', () => {
          const expanded = btn.getAttribute('aria-expanded') === 'true';
            btn.setAttribute('aria-expanded', String(!expanded));
            nav.classList.toggle('hidden');
            if (icon) icon.innerHTML = expanded ? '<path d="M3 6h18M3 12h18M3 18h18" />' : '<path d="M6 6l12 12M6 18L18 6" />';
        });
        links.forEach(a => a.addEventListener('click', () => {
          if (window.innerWidth < 768 && !nav.classList.contains('hidden')) {
            nav.classList.add('hidden');
            btn.setAttribute('aria-expanded', 'false');
            resetIcon();
          }
        }));
        window.addEventListener('resize', () => {
          if (window.innerWidth >= 768) {
            nav.classList.remove('hidden');
            btn.setAttribute('aria-expanded', 'true');
          } else {
            nav.classList.add('hidden');
            btn.setAttribute('aria-expanded', 'false');
          }
          resetIcon();
        });
      }

      // Scrollspy
      const setActive = (id) => {
        links.forEach(a => {
          const href = a.getAttribute('href');
          const match = id && href && href.substring(1) === id;
          a.classList.toggle('nav-link-active', !!match);
          if (match) a.setAttribute('aria-current', 'true'); else a.removeAttribute('aria-current');
        });
      };
      function onScroll() {
        const headerH = header ? header.offsetHeight : 0;
        const scrollPos = window.scrollY + headerH + 24;
        let current = null;
        for (const id of sectionIds) {
          const el = document.getElementById(id);
          if (el && el.offsetTop <= scrollPos) current = id;
        }
        setActive(current);
      }
      if (sectionIds.length) {
        document.addEventListener('scroll', onScroll, { passive: true });
        onScroll();
      }

      // Tema
      const themeBtn = document.getElementById('themeToggle');
      const themeIcon = document.getElementById('themeIcon');
      const setThemeVisual = () => {
        const dark = document.documentElement.classList.contains('dark');
        if (themeIcon) themeIcon.innerHTML = dark
          ? '<svg width="20" height="20" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"/></svg>'
          : '<svg width="20" height="20" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0"/><path d="M3 12h1m8 -9v1m8 8h1m-9 8v1m-6.4 -15.4l.7 .7m12.1 -.7l-.7 .7m0 11.4l.7 .7m-12.1 -.7l-.7 .7"/>';
        if (themeBtn) themeBtn.setAttribute('aria-label', dark ? 'Cambiar a modo claro' : 'Cambiar a modo oscuro');
      };
      if (themeBtn) {
        setThemeVisual();
        themeBtn.addEventListener('click', () => {
          const isDark = document.documentElement.classList.toggle('dark');
          localStorage.setItem('theme', isDark ? 'dark' : 'light');
          setThemeVisual();
        });
      }
    });
  </script>
</header>
